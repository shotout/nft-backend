"use strict";function toggleWholeSalePrice(){$("#wholesalePrice").is(":checked")?$("#wholesalePriceField").hide():$("#wholesalePriceField").show()}function toggleMultiVariants(){$("#multi_variants").is(":checked")?($("#multiVariantsBlock").show(),$("#rdoAttribute").html(jsLang("Attributes"))):($("#multiVariantsBlock").hide(),$("#rdoAttribute").html(jsLang("Enable Attribute")))}function toggleManageStock(){$("#manageStock").is(":checked")?($("#initialStockBlock").show(),$("#rdoStock").html(jsLang("Current Stocks"))):($("#initialStockBlock").hide(),$("#rdoStock").html(jsLang("Manage Stock Level")))}function toggleItemType(){"service"==$("#itemType").val()?($("#variant-tab").hide(),$("#multiVariantsBlock").hide(),$("#stock-tab").hide(),$("#initialStockBlock").hide(),$("#manageStock").prop("checked",!1),$("#multi_variants").prop("checked",!1)):($("#variant-tab").show(),$("#stock-tab").show())}function toggleSizeVariant(){if($("#sizeVariant").is(":checked")){var e=$("#sizeInput").val().trim();$("#sizeInput").val(e),$("#sizeInput").removeAttr("disabled")}else $("#sizeInput").val(" "),$("#sizeInput").trigger("keyup"),$("#sizeInput").attr("disabled","true")}function toggleColorVariant(){if($("#colorVariant").is(":checked")){var e=$("#colorInput").val().trim();$("#colorInput").val(e),$("#colorInput").removeAttr("disabled")}else $("#colorInput").val(" "),$("#colorInput").trigger("keyup"),$("#colorInput").attr("disabled","true")}function toggleWeightVariant(){if($("#weightVariant").is(":checked")){$("#weightInput").removeAttr("disabled"),$("#weightUnit").removeAttr("disabled"),$("#weightInput").hasClass("positive-float-number")||$("#weightInput").addClass("positive-float-number");var e=$("#weightInput").val().trim();$("#weightInput").val(e)}else $("#weightInput").removeClass("positive-float-number"),$("#weightInput").val(" "),$("#weightInput").trigger("keyup"),$("#weightInput").attr("disabled","true"),$("#weightUnit").attr("disabled","true")}if($(".main-body .page-wrapper").find("#add-item-container").length){function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;$("#prvw").removeAttr("hidden"),$("#blah").removeAttr("hidden"),t.onload=function(e){$("#blah").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}$(".select2").select2(),toggleMultiVariants(),toggleManageStock(),toggleItemType(),toggleSizeVariant(),toggleColorVariant(),toggleWeightVariant();var purchase_price=$("#purchase_price").val(),retail_price=$("#retail_price").val(),costPrice=$("#costPrice").val(),initialStock=$("#initialStock").val(),alert_quantity=$("#alert_quantity").val();$("#purchase_price").val(getDecimalNumberFormat(purchase_price)),$("#retail_price").val(getDecimalNumberFormat(retail_price)),$("#costPrice").val(getDecimalNumberFormat(costPrice)),$("#initialStock").val(getDecimalNumberFormat(initialStock)),$("#alert_quantity").val(getDecimalNumberFormat(alert_quantity)),$("#validatedCustomFile").on("change",function(){$(this).next(".custom-file-label").html($(this)[0].files[0].name)}),$("#itemAddForm").validate({rules:{item_id:{required:!0,remote:{url:SITE_URL+"/item/stock_id_validation",type:"GET",data:{stock_id:function(){return $("input[name=item_id]").val()}}}},item_name:{required:!0,remote:{url:SITE_URL+"/item/name_validation",type:"GET",data:{description:function(){return $("input[name=item_name]").val()}}}},category_id:{required:!0},purchase_price:{required:!0},tax_type_id:{required:!0},units:{required:!0},initial_stock:{required:!0},size:{customSize:!0},color:{customColor:!0},weight:{customWeight:!0},alert_quantity:{required:!1},cost_price:{required:!0},item_image:{fileType:"jpg|png|gif",remote:function(e){if(0!=e.files.length)return{url:SITE_URL+"/is-valid-file-size",data:{filesize:e.files[0].size}}}}}}),$("#validatedCustomFile").on("change",function(){$("#validatedCustomFile").valid()}),jQuery.validator.addMethod("customSize",function(e,t){return!$("#multi_variants").is(":checked")||""!=e},jsLang("This field is required.")),jQuery.validator.addMethod("customColor",function(e,t){return!$("#multi_variants").is(":checked")||""!=e},jsLang("This field is required.")),jQuery.validator.addMethod("customWeight",function(e,t){return!$("#multi_variants").is(":checked")||""!=e},jsLang("This field is required.")),$("#item_id").on("keyup",function(){var e=$(this).val().trim();""!=e?$.ajax({method:"GET",url:SITE_URL+"/item/stock_id_validation",data:{item_id:e}}).done(function(e){1==(e=JSON.parse(e)).status_no?($("#errMsg").html(""),$("#errMsg").removeClass("text-success"),$("#errMsg").addClass("text-danger")):0==e.status_no&&($("#errMsg").html(jsLang("Available")),$("#errMsg").removeClass("text-danger"),$("#errMsg").addClass("text-success"))}):($("#errMsg").html(""),$("#errMsg").removeClass("text-success"),$("#errMsg").addClass("text-danger"))}),$("#item_name").on("keyup",function(){var e=$(this).val().trim();""!=e?$.ajax({method:"GET",url:SITE_URL+"/item/name_validation",data:{description:e}}).done(function(e){1==(e=JSON.parse(e)).status_no?($("#checkMsg").html(""),$("#checkMsg").removeClass("text-success"),$("#checkMsg").addClass("text-danger")):0==e.status_no&&($("#checkMsg").html(jsLang("This name is available to use")),$("#checkMsg").removeClass("text-danger"),$("#checkMsg").addClass("text-success"))}):($("#checkMsg").html(""),$("#checkMsg").removeClass("text-success"),$("#checkMsg").addClass("text-danger"))}),$("#manageStock").on("change",function(){toggleManageStock()}),$("#multi_variants").on("change",function(e){toggleMultiVariants()}),$("#sizeVariant").on("change",function(){toggleSizeVariant()}),$("#colorVariant").on("change",function(){toggleColorVariant()}),$("#weightVariant").on("change",function(){toggleWeightVariant()});var rowid=1;function customVariantTitleValidation(){var e,t=0,a=0;$(".customVariantDiv").each(function(){0});var i=[];return $(".customVariantDiv").each(function(){i.push($(this).attr("id").split("-").pop())}),$.each(i,function(i,n){e=0;var r=0;$.each($("#variant-value-"+n),function(){$(this).val()&&(e=1),$("#variant-title-"+n).val()&&(r=1)}),0==e?($("#variant-value-"+n).addClass("err1"),$("#extra-variant-value-"+n).text(jsLang("This field is required.")),a=1):($("#variant-value-"+n).removeClass("err1"),$("#extra-variant-value-"+n).text("")),0==r?($("#variant-title-"+n).addClass("err1"),$("#extra-variant-title-"+n).text(jsLang("This field is required.")),t=1):($("#variant-title-"+n).removeClass("err1"),$("#extra-variant-title-"+n).text(""))}),1!=a&&1!=t||(event.preventDefault(),!1)}$("#customVariantBtn").on("click",function(e){e.preventDefault();var t=!1;$(".custom-variant-title").length>0&&$.each($(".custom-variant-title"),function(e,a){if(""==a.value)return a.focus(),t=!0,!1}),$(".custom-variant-value").length>0&&$.each($(".custom-variant-value"),function(e,a){if(""==a.value)return a.focus(),t=!0,!1});var a=`\n    <div class="form-group row customVariantDiv" id="rowid-${rowid}">\n      <div class="col-md-2 col-sm-3">\n        <input  data-rel="${rowid}" data-text="extra-variant-title" name="variant_title[]" type="text" class="form-control custom-variant-title" id="variant-title-${rowid}">\n        <span id="extra-variant-title-${rowid}" class="validationMsg"></span>\n      </div>\n      <div class="col-md-7 col-sm-5">\n        <input type="text" data-rel="${rowid}" data-text="extra-variant-value" id="variant-value-${rowid}" name="variant_value[]" class="form-control custom-variant-title">\n        <span id="extra-variant-value-${rowid}" class="validationMsg"></span>\n      </div>\n      <div class="col-md-1 col-sm-2 text-right">\n        <button type="button" data-row-id="${rowid}" class="btn btn-xs btn-danger m-t-5 deleteCustomVariant"><i class="fa fa-trash"></i></button>\n      </div>\n    </div>`;t||($("#customVariantBlock").append(a),rowid++)}),$(document).on("click",".deleteCustomVariant",function(e){e.preventDefault();var t=$(this).attr("data-row-id");$("#rowid-"+t).remove()}),$("#itemType").on("change",function(){toggleItemType()}),$(document).on("keyup focus",".custom-variant-title",function(){customVariantTitleValidation()}),$("#itemAddForm").on("submit",function(){customVariantTitleValidation()}),$(window).on("load",function(){$(window).width()<=575&&($("#weightUnitDiv").addClass("mt-1"),$("#weightUnitDiv").addClass("itemWeightForSmallDevice"),$("#note_txt_2").addClass("mt-1"))})}if($(".main-body .page-wrapper").find("#edit-item-container").length){function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$("#blah_1").attr("src",e.target.result),$("#blah_2").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}$(".select2").select2(),toggleWholeSalePrice(),$("#wholesalePriceCheck").on("change",function(e){toggleWholeSalePrice()}),$(".dataTable").addClass("item-datatable"),$("#validatedCustomFile").on("change",function(e){for(var t=[],a=0;a<$(this)[0].files.length;a++)t.push($(this)[0].files[a].name);$(this).next(".custom-file-label").html(t.join(", "))});purchase_price=$("#purchase_price").val(),retail_price=$("#retail_price").val();var weightInput=$("#weightInput").val();function toggleWholeSalePrice(){$("#wholesalePriceCheck").is(":checked")?$("#wholesalePriceField").hide():$("#wholesalePriceField").show()}function customVariantTitleValidation(){var e,t=0,a=0;$(".text_box").each(function(){t++});for(var i=1;i<=t;i++)e=0,$.each($("#variant-value-"+i),function(){$(this).val()&&(e=1)}),0==e?($("#variant-value-"+i).addClass("err1"),$("#extra-variant-value-"+i).text(jsLang("This field is required.")),a=1):($("#variant-value-"+i).removeClass("err1"),$("#extra-variant-value-"+i).text(""));var n=!1;return $(".custom-variant-value").length>0&&$.each($(".custom-variant-value"),function(e,t){if(""==t.value)return t.focus(),n=!0,!1}),1!=a&&1!=n||(event.preventDefault(),!1)}$("#purchase_price").val(getDecimalNumberFormat(purchase_price)),$("#retail_price").val(getDecimalNumberFormat(retail_price)),weightInput&&$("#weightInput").val(getDecimalNumberFormat(weightInput)),$("#confirmDelete").on("show.bs.modal",function(e){var t=$(e.relatedTarget),a=$(this);$("#confirmDeleteSubmitBtn").attr("data-task","").removeClass("delete-task-btn"),"Delete"==t.data("label")&&(a.find("#confirmDeleteSubmitBtn").addClass("delete-task-btn").attr("data-id",t.data("id")).text(jsLang("Delete")).show(),a.find("#confirmDeleteLabel").text(t.data("title")),a.find(".modal-body").text(t.data("message"))),$("#confirmDeleteSubmitBtn").on("click",function(){$("#delete-item-"+$(this).attr("data-id")).trigger("submit")})}),$("#statusManage").on("change",function(){var e=$(this).is(":checked")?1:0;e=e?1:0;var t=itemID;$.ajax({url:SITE_URL+"/item/stock-update-ajax",method:"POST",data:{id:t,flag:e,_token:token},success:function(e){"1"==JSON.parse(e)?($("#msgStatus").fadeIn(),$("#msgStatus").html("").css("color","white")):($("#msgStatus").fadeIn(),$("#msgStatus").html(jsLang("Stock Management Disabled")).css("color","red"))}})}),$("#itemEditForm").validate({rules:{stock_id:{required:!0,remote:{url:SITE_URL+"/item/stock_id_validation",type:"GET",data:{stock_id:function(){return $("input[name=stock_id]").val()},id:currentItemId}}},item_name:{required:!0,remote:{url:SITE_URL+"/item/name_validation",type:"GET",data:{description:function(){return $("input[name=item_name]").val()},id:currentItemId}}},item_type:"required",category_id:"required",units:"required",tax_type_id:"required",retail_price:{required:!1},wholesale_price:{required:!1},purchase_price:{required:!0},size:"required",color:"required",weight:{required:!0},item_image:{fileType:"jpg|png|gif",remote:function(e){if(0!=e.files.length)return{url:SITE_URL+"/is-valid-file-size",data:{filesize:e.files[0].size}}}}},onfocusout:function(e,t){this.element(e)}}),$("#validatedCustomFile").on("change",function(){$("#validatedCustomFile").valid()}),jQuery.extend(jQuery.validator.messages,{min:jQuery.validator.format("Minimum 0.")}),$("#item_name").on("keyup",function(){$("#checkMsg").html("");var e=$(this).val().trim(),t=$("#old_item_name").val().trim();""!=e&&e!=t?$.ajax({method:"GET",url:SITE_URL+"/item/name_validation",data:{description:e}}).done(function(e){1==(e=JSON.parse(e)).status_no?($("#checkMsg").html(""),$("#checkMsg").removeClass("text-success"),$("#checkMsg").addClass("text-danger")):0==e.status_no&&($("#checkMsg").html(jsLang("This name is available to use")),$("#checkMsg").removeClass("text-danger"),$("#checkMsg").addClass("text-success"))}):($("#checkMsg").html(""),$("#checkMsg").removeClass("text-success"),$("#checkMsg").addClass("text-danger"))}),$("#itemType").on("change",function(){"service"==$(this).val()?$("#fullVariantBlock").hide():$("#fullVariantBlock").show()}),$("#transaction-variant-list-info_length").css("color","red"),$(document).on("click","#csv, #pdf",function(e){window.location=SITE_URL+"/variant-item-download"+this.id+"/"+itemID}),$(document).on("keyup focus",".custom-variant-value",function(){customVariantTitleValidation()}),$("#itemEditForm").on("submit",function(e){customVariantTitleValidation()}),$(window).on("load",function(){"service"==$("#itemType").val()?($("#stock_management").hide(),$("#status-tab").hide(),$("#transactions-tab").hide()):($("#stock_management").show(),$("#status-tab").show(),$("#transactions-tab").show())}),$("form#itemEditForm").trigger("submit")}if($(".main-body .page-wrapper").find("#import-item-container").length&&($("#myform1").on("submit",function(e){var t=0;$(".valdation_check").each(function(){var e=$(this).attr("id");""==$("#"+e).val()&&($("#val_"+e).html(jsLang("This field is required.")),t=1)}),$(".valdation_select").each(function(){var e=$(this).attr("id");""==$("#"+e).val()&&($("#val_"+e).html(jsLang("This field is required.")),t=1)}),1==t&&e.preventDefault()}),$(".valdation_check").on("keypress keyup",function(){var e=$(this).attr("id");$("#val_"+e).html("")}),$(".valdation_select").on("click",function(){var e=$(this).attr("id");$("#val_"+e).html("")}),$("#fileRequest").on("click",function(){window.location=SITE_URL+"/public/dist/downloads/ItemImport.csv"}),$(".error").hide(),$("#note_txt_2").hide(),$("#validatedCustomFile").on("change",function(){for(var e=[],t=0;t<$(this)[0].files.length;t++)e.push($(this)[0].files[t].name);$(this).next(".custom-file-label").html(e.join(", "));var a=e.toString().split(".").pop();-1==$.inArray(a,["csv"])?($("#note_txt_1").hide(),$("#note_txt_2").show(),$("#note_txt_2").html('<h6> <span class="text-danger font-weight-bolder"> '+jsLang("Invalid file Extension.")+' </span> </h6> <span class="badge badge-danger">'+jsLang("Note")+"!</span>"+jsLang("Allowed File Extensions: csv")),$("#submit").attr("disabled","disabled")):($("#submit").removeAttr("disabled"),$("#note_txt_1").hide())})),$(".main-body .page-wrapper").find(".list-container").length&&($("#confirmDelete").on("show.bs.modal",function(e){var t=$(e.relatedTarget),a=$(this);if($("#confirmDeleteSubmitBtn").attr("data-task","").removeClass("delete-task-btn"),"Delete"==t.data("label"))a.find("#confirmDeleteSubmitBtn").addClass("delete-task-btn").attr("data-task",t.data("id")).text(jsLang("Delete")).show(),a.find("#confirmDeleteLabel").text(t.data("title")),a.find(".modal-body").text(t.data("message"));else{a.find(".modal-body").html('<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>'),a.find(".modal-body").load(t.data("remote"))}}),$("#confirmDeleteSubmitBtn").on("click",function(){$("#delete-item-"+$(this).data("task")).trigger("submit")}),$("#dataTableBuilder").on("change",".status",function(){var e=$(this).attr("data-customer_id");if($(this).is(":checked"))var t="0";else t="1";var a=SITE_URL+"/customer/change-status";$.ajax({url:a,method:"POST",data:{id:e,status:t,_token:token},dataType:"json",success:function(e){"success"==e.status&&$("#dataTableBuilder").DataTable().ajax.reload(null,!1)}})}),$(document).on("click","#pdf",function(e){window.location=SITE_URL+"/itemdownloadpdf"}),$(document).on("click","#csv",function(e){window.location=SITE_URL+"/itemdownloadcsv/csv"}),$("#dataTableBuilder").addClass("item-datatable")),$(".main-body .page-wrapper").find("#item-variant-container").length){function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;$("#prvw").removeAttr("hidden"),$("#blah").removeAttr("hidden"),t.onload=function(e){$("#blah").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}$(".custom_select_2").select2(),toggleWholeSalePrice(),toggleManageStock(),$("#validatedCustomFile").on("change",function(){$("#validatedCustomFile").valid()});purchase_price=$("#purchase_price").val(),retail_price=$("#retail_price").val(),costPrice=$("#costPrice").val(),initialStock=$("#initialStock").val(),alert_quantity=$("#alert_quantity").val();function toggleWholeSalePrice(){$("#wholesalePrice").is(":checked")?$("#wholesalePriceField").hide():$("#wholesalePriceField").show()}function toggleManageStock(){$("#manageStock").is(":checked")?$("#initialStockBlock").show():$("#initialStockBlock").hide()}$("#purchase_price").val(getDecimalNumberFormat(purchase_price)),$("#retail_price").val(getDecimalNumberFormat(retail_price)),$("#costPrice").val(getDecimalNumberFormat(costPrice)),$("#initialStock").val(getDecimalNumberFormat(initialStock)),$("#alert_quantity").val(getDecimalNumberFormat(alert_quantity)),$("#validatedCustomFile").on("change",function(){$(this).next(".custom-file-label").html($(this)[0].files[0].name)}),$("#variantAddForm").validate({rules:{stock_id:{required:!0,remote:{url:SITE_URL+"/item/stock_id_validation",type:"GET",data:{stock_id:function(){return $("input[name=stock_id]").val()}}}},item_name:{required:!0,remote:{url:SITE_URL+"/item/name_validation",type:"GET",data:{description:function(){return $("input[name=item_name]").val()}}}},purchase_price:{required:!0},wholesale_price:{required:!1},retail_price:{required:!1},size:{required:!0},color:{required:!0},weight:{required:!0},initial_stock:{required:!0},alert_quantity:{required:!1},cost_price:{required:!0},item_image:{fileType:"jpg|png|gif",remote:function(e){if(0!=e.files.length)return{url:SITE_URL+"/is-valid-file-size",data:{filesize:e.files[0].size}}}}}}),$("#stock_id").on("keyup",function(){var e=$(this).val().trim();""!=e?$.ajax({method:"GET",url:SITE_URL+"/item/stock_id_validation",data:{item_id:e}}).done(function(e){1==(e=JSON.parse(e)).status_no?($("#errMsg").html(""),$("#errMsg").removeClass("text-success"),$("#errMsg").addClass("text-danger")):0==e.status_no&&($("#errMsg").html(jsLang("Available")),$("#errMsg").removeClass("text-danger"),$("#errMsg").addClass("text-success"))}):$("#errMsg").html("")}),$("#item_name").on("keyup",function(){var e=$(this).val().trim();""!=e?$.ajax({method:"GET",url:SITE_URL+"/item/name_validation",data:{description:e}}).done(function(e){1==(e=JSON.parse(e)).status_no?($("#checkMsg").html(""),$("#checkMsg").removeClass("text-success"),$("#checkMsg").addClass("text-danger")):0==e.status_no&&($("#checkMsg").html(jsLang("Available")),$("#checkMsg").removeClass("text-danger"),$("#checkMsg").addClass("text-success"))}):$("#checkMsg").html("")}),$("#wholesalePrice").on("change",function(e){toggleWholeSalePrice()}),$("#manageStock").on("change",function(){toggleManageStock()}),$("#sizeVariant").on("change",function(){$(this).is(":checked")?$("#sizeInput").removeAttr("disabled"):$("#sizeInput").attr("disabled","true")}),$("#colorVariant").on("change",function(){$(this).is(":checked")?$("#colorInput").removeAttr("disabled"):$("#colorInput").attr("disabled","true")}),$("#weightVariant").on("change",function(){$(this).is(":checked")?($("#weightInput").removeAttr("disabled"),$("#weightUnit").removeAttr("disabled")):($("#weightInput").attr("disabled","true"),$("#weightUnit").attr("disabled","true"))});rowid=1;function customVariantTitleValidation(){var e,t=0,a=0;$(".variantDiv").each(function(){t++});for(var i=1;i<=t;i++)e=0,$.each($("#variant-value-"+i),function(){$(this).val()&&(e=1)}),0==e?($("#variant-value-"+i).addClass("err1"),$("#extra-variant-value-"+i).text(jsLang("This field is required.")),a=1):($("#variant-value-"+i).removeClass("err1"),$("#extra-variant-value-"+i).text(""));return 1!=a||(event.preventDefault(),!1)}$(document).on("click",".deleteCustomVariant",function(e){e.preventDefault();var t=$(this).attr("data-row-id");$("#rowid-"+t).remove()}),$(document).on("keyup focus",".custom-variant-value",function(){customVariantTitleValidation()}),$("#variantAddForm").on("submit",function(e){customVariantTitleValidation()}),$(window).on("load",function(){$(window).width()<=575&&$("#weightUnitDiv").addClass("mt-1")})}
