"use strict";$("#dataTableBuilder, .task-v-preview").on("click",".task_class, .add-attachments",function(){var a=$(this).attr("data-id");$.ajax({url:SITE_URL+"/task/files",data:{task_id:a},type:"GET",dataType:"JSON",success:function(a){if(1==a.status){var t="",e=["gif","png","jpg","jpeg"];$.each(a.files,function(a,s){var l=s.file_name.split(".").pop();if("Task"==s.object_type&&"-1"!=jQuery.inArray(l,e))var i="/public/uploads/tasks/"+s.file_name,n='<a class="cursor_pointer" href="'+SITE_URL+"/"+i+'"  data-lightbox="image-1"> <img src="'+SITE_URL+"/"+i+'" alt="'+s.original_file_name+'" class="img-thumbnail attachment-styles"></a>';else n='<p class="attachment_name">'+l+"</p>";var d="/public/uploads/tasks/"+s.file_name,r=s.original_file_name;null!=r&&(r=r.length>50?(r=r.trim()).substring(0,48)+"...":s.original_file_name),t+='<table class="table_styles" id="table_id_'+s.id+'"><tr ><td class="td_styles">'+n+'</td><td class="td_styles1">&nbsp;&nbsp;</td><td class="td_styles1"><span title="'+s.original_file_name+'">'+r+'</span><a href="'+SITE_URL+"/"+d+'" data-toggle="tooltip" data-placement="top" title="Download" class="cursor_pointer ml-15" download="'+s.file_name+'"><i class="fa fa-download"></i><a/><i class="feather icon-trash-2 attachment-item-delete color_red cursor_pointer ml-15" data-id="'+s.id+'"></i><br/>'+jsLang("File Added")+" : "+s.created_at+"<br/></td></tr></table>"}),$("#filesDiv").css("display","block"),$("#files").html(t)}else $("#filesDiv").css("display","none")}})});var statusPicture=$("#uploader-text"),msg="";$(".dropzone-attachments").dropzone({url:SITE_URL+"/task/file-upload?type=task",paramName:"attachment",headers:{"X-CSRF-TOKEN":token},createImageThumbnails:!1,sending:function(a,t,e){e.append("task_id",$("#task_id").val()),statusPicture.text(jsLang("Uploading..."))},maxFiles:15,clickable:[$(".add-attachments").get(0)],error:function(){statusPicture.text(jsLang("Upload failed, unknown error!"))},complete:function(a){0===this.getUploadingFiles().length&&0===this.getQueuedFiles().length&&statusPicture.html(msg)},success:function(a,t){var e=JSON.parse(t);if(1==e.result){SITE_URL,e.data.attachment_id,e.data.task_id;if(-1!=jQuery.inArray(e.data.attachment_extension,["gif","png","jpg","jpeg"]))var s="/public/uploads/tasks/"+e.data.attachment_name,l='<a class="cursor_pointer" href="'+SITE_URL+"/"+s+'"  data-lightbox="image-1"> <img src="'+SITE_URL+"/"+s+'" alt="'+e.data.attachment_original_name+'" class="img-thumbnail attachment-styles"></a>';else l='<p class="attachment_name">'+e.data.attachment_name.split(".").pop()+"</p>";var i="/public/uploads/tasks/"+e.data.attachment_name,n=e.data.attachment_original_name;null!=n&&(n=n.length>50?(n=n.trim()).substring(0,48)+"...":e.data.attachment_original_name);var d='<table class="table-hover table_styles" id="table_id_'+e.data.attachment_id+'"><tr ><td class="td_styles">'+l+'</td><td class="td_styles1">&nbsp;&nbsp;</td><td class="td_styles1"><span title="'+e.data.attachment_original_name+'">'+n+'</span><a href="'+SITE_URL+"/"+i+'" data-toggle="tooltip" data-placement="top" title="Download" class="cursor_pointer ml-15" download="'+e.data.attachment_name+'"><i class="fa fa-download"></i><a/><i class="feather icon-trash-2 attachment-item-delete color_red cursor_pointer ml-15" data-id="'+e.data.attachment_id+'"></i><br/>'+jsLang("File Added")+" : "+e.data.created_at+"<br/></td></tr></table>";$("#files").prepend(d),msg=""}else msg='<span class="text-danger">'+e.data.errorMessage+"</span>"}}),deleteAttachment(SITE_URL+"/task/file-remove?type=task"),$("#task-modal").on("hide.bs.modal",function(a){$(".list-attachments").remove()});